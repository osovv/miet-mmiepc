### Контрольные вопросы

1. **Теорема Эйлера.**

   - Теорема Эйлера утверждает, что если $( a )$ и $( m )$ взаимно просты, то $a^{\phi(m)} \equiv 1 \pmod{m} $, где $\phi(m)$ — функция Эйлера. Если $( m )$ является простым числом, теорема Эйлера превращается в малую теорему Ферма: $( a^{m-1} \equiv 1 \pmod{m} )$.

2. **Свойства функции Эйлера.**

   - Функция Эйлера $( \phi(n) )$ определяет количество натуральных чисел, меньших $( n )$ и взаимно простых с ним. Основные свойства:
     - Если $( p )$ — простое число, то $( \phi(p) = p - 1 )$.
     - Если $( n = p_1^{k_1} \cdot p_2^{k_2} \cdot \ldots \cdot p_m^{k_m} )$ (разложение на простые множители), то $( \phi(n) = n \cdot (1 - \frac{1}{p_1}) \cdot (1 - \frac{1}{p_2}) \cdot \ldots \cdot (1 - \frac{1}{p_m}) )$.

3. **Изложите принципиальную схему организации обмена документами, заверенными цифровой подписью.**

   - Принципиальная схема обмена документами с ЭЦП включает следующие шаги:
     1. Отправитель создает электронный документ.
     2. Вычисляет хэш от документа с использованием криптографической хэш-функции.
     3. Шифрует хэш с использованием своего закрытого ключа, создавая таким образом цифровую подпись.
     4. Присоединяет цифровую подпись к документу и отправляет получателю.
     5. Получатель расшифровывает подпись с использованием открытого ключа отправителя, получая хэш.
     6. Вычисляет хэш от полученного документа.
     7. Сравнивает полученные хэши. Если они совпадают, документ считается подлинным и не измененным.

4. **Перечислите основные требования, предъявляемые к хэш-функции, пригодной для использования при вычислении цифровой подписи документа.**

   - Основные требования к хэш-функции:
     - **Односторонность**: Хэш-функция должна быть необратимой.
     - **Устойчивость к коллизиям**: Невозможность нахождения двух различных входных данных, которые дают одинаковый хэш.
     - **Высокая скорость вычислений**: Хэш-функция должна быть быстрой для обработки больших объемов данных.
     - **Детерминированность**: Одинаковые входные данные должны всегда давать один и тот же хэш.

5. **Назовите и охарактеризуйте методы, реализующие ЭЦП.**

   - Основные методы реализации ЭЦП:
     - **RSA**: Использует факторизацию больших чисел, безопасность основана на сложности разложения больших чисел на множители.
     - **DSA (Digital Signature Algorithm)**: Основывается на вычислительной сложности задачи дискретного логарифмирования.
     - **Эль-Гамаль**: Также основан на сложности задачи дискретного логарифмирования, позволяет использовать один секретный ключ для множества подписей.

6. **Расскажите, каким образом с помощью криптосистемы RSA можно организовать передачу сообщений, подлинность которых подтверждена цифровой подписью. Приведите примеры.**

   - Процесс:
     1. Отправитель вычисляет хэш от сообщения.
     2. Шифрует хэш с помощью своего закрытого ключа, создавая цифровую подпись.
     3. Отправляет сообщение вместе с цифровой подписью получателю.
     4. Получатель расшифровывает цифровую подпись с помощью открытого ключа отправителя, получая хэш.
     5. Вычисляет хэш от полученного сообщения и сравнивает его с расшифрованным хэшем. Совпадение подтверждает подлинность и целостность сообщения.
   - Пример:

     ```python
     import hashlib
     from Crypto.PublicKey import RSA
     from Crypto.Signature import pkcs1_15

     # Создание ключей
     key = RSA.generate(2048)
     private_key = key.export_key()
     public_key = key.publickey().export_key()

     # Подпись сообщения
     message = b"Hello, this is a signed message."
     hash = hashlib.sha256(message).digest()
     signature = pkcs1_15.new(RSA.import_key(private_key)).sign(hash)

     # Проверка подписи
     try:
         pkcs1_15.new(RSA.import_key(public_key)).verify(hash, signature)
         print("Signature is valid.")
     except (ValueError, TypeError):
         print("Signature is invalid.")
     ```

7. **Расскажите, каким образом с помощью криптосистемы Эль-Гамаля можно организовать передачу сообщений, подлинность которых подтверждена цифровой подписью. Приведите примеры.**

   - Процесс:
     1. Отправитель вычисляет хэш от сообщения.
     2. Использует случайное число $( k )$ и свой закрытый ключ для создания подписи (пара значений $( r )$ и $( s )$).
     3. Отправляет сообщение вместе с подписью получателю.
     4. Получатель использует открытый ключ отправителя для проверки подписи, вычисляя соответствие.
   - Пример:

     ```python
     from Crypto.PublicKey import ElGamal
     from Crypto.Hash import SHA256
     from Crypto.Random import get_random_bytes
     from Crypto.Signature import DSS

     # Создание ключей
     key = ElGamal.generate(2048, get_random_bytes)
     private_key = key
     public_key = key.publickey()

     # Подпись сообщения
     message = b"Hello, this is a signed message."
     hash = SHA256.new(message)
     signer = DSS.new(private_key, 'fips-186-3')
     signature = signer.sign(hash)

     # Проверка подписи
     verifier = DSS.new(public_key, 'fips-186-3')
     try:
         verifier.verify(hash, signature)
         print("Signature is valid.")
     except ValueError:
         print("Signature is invalid.")
     ```

8. **Сравните наиболее распространенные стандарты ЭЦП.**
   - **RSA**:
     - Основывается на сложности факторизации больших чисел.
     - Хорошо изучен, широко используется.
     - Подпись и ключи могут быть большими по размеру.
   - **DSA**:
     - Основывается на задаче дискретного логарифмирования.
     - Обычно более быстр для создания подписи, но медленнее для проверки.
     - Подпись и ключи меньше по размеру, чем у RSA.
   - **Эль-Гамаль**:
     - Тоже основан на дискретном логарифмировании.
     - Позволяет использовать один секретный ключ для множества подписей.
     - Подписи больше по размеру, чем у RSA и DSA.
   - **ГОСТ 34.10-2018**:
     - Использует эллиптические кривые.
     - Высокая криптостойкость, меньшие размеры ключей и подписей.
     - Основан на сложности задачи дискретного логарифмирования в группе точек эллиптической кривой.
